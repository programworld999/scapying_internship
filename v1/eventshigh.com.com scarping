{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "Success!\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-11-10T18:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/db0e3551f9b5ba73a7a27f75e89ce145-self-actualized-leadership-development-workshop', 'address': 'Hotel Hindusthan International, 235, 1, Acharya Jagadish Chandra Bose Rd, Sreepally, Elgin, Kolkata, West Bengal 700020, India', 'title': 'Self-Actualized Leadership Development Workshop', 'price': ' 3500.0 ', 'organization_name': 'Defined Values Consultants', 'starting_date_time': '2019-11-10T09:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-10-07T17:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/ca1a92aac5234ecdd91c23f7c740e1d8-devi-pokkhe-durga-darshan-durga', 'address': 'The LaLiT Great Eastern Kolkata, 1, 2, 3, Old Court House Street, Dalhousie Square, Near Raj Bhavan, Kolkata, West Bengal 700069', 'title': 'Devi Pokkhe Durga Darshan - Durga Puja Parikrama Bonedibari Durga Darshan 2019', 'price': ' 3000.0 ', 'organization_name': 'RHYTHM GALAXY GROUP', 'starting_date_time': '2019-10-07T07:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-08-03T16:30:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/6c13b5361c752c34dd5489279438a19a-top-sales-training-in-kolkata', 'address': 'Live Online Trainer Led Sales Training Workshop, Join from the comfort of your home or office using Laptop/Mobile Phone and Internet', 'title': 'Top Sales Training in Kolkata', 'price': ' 2999.0 ', 'organization_name': 'Amit Sharma Sales Leader', 'starting_date_time': '2019-08-03T10:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-10-06T17:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/4d090f5de169fcbdc12e72479f6b5dcb-belur-math-sabeki-barir-puja', 'address': 'Pantaloons Garia Bazaar, Sreeram Estate, Laxmi Narayan Colony, Garia, Kolkata, West Bengal 700047, India', 'title': 'Belur Math &amp; Sabeki Barir Puja Parikrama', 'price': ' 2150.0 ', 'organization_name': 'Niladri Roy', 'starting_date_time': '2019-10-06T07:30:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-11-16T17:30:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/a5421c0a90650ed9c3ea5ec1465e0481-one-day-workshop-on-advanced', 'address': 'The Senator Hotel, 15, Camac St, Elgin, Kolkata, West Bengal 700017, India', 'title': 'One day Workshop on Advanced Excel', 'price': ' 1950.0 ', 'organization_name': 'Infidea Trainings', 'starting_date_time': '2019-11-16T10:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-10-19T17:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/f897bc3b3ed93cedf79582fbb86027b8-how-to-start-your-startups', 'address': 'OYO Townhouse 011 Esplanade, Plot No. 5A, Sudder St, near Fire Brigade, Colootola, New Market Area, Dharmatala, Taltala, Kolkata, West Bengal 700016, India', 'title': 'How to Start your Startups-A Complete Guidance &amp; Mentoring Program', 'price': ' 3000.0 ', 'organization_name': 'The Inspire India', 'starting_date_time': '2019-10-19T10:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-11-21T17:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/ec39ee8ddb515eea1903451835b570f3-kpmg-lean-six-sigma-green', 'address': 'KPMG, KPMG, Godrej Waterside, Unit No. 603 &amp; 604, 6th Floor, Tower 1, Sector - V, Salt Lake, DP Block, Sector V, Bidhannagar, Kolkata, West Bengal 700091, India', 'title': 'KPMG Lean Six Sigma Green Belt Training in Kolkata', 'price': ' 23600.0 ', 'organization_name': 'Lean Six Sigma', 'starting_date_time': '2019-11-18T09:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-10-12T15:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/42c170f38c2fb885b545bd34dab6f0d7-big-data-machine-learning-and', 'address': 'Online On Demand, Bhowanipore, Kolkata, West Bengal 700025, India', 'title': 'Big Data- Machine Learning and it&#x27;s Applications Workshop', 'price': ' 5000.0 ', 'organization_name': 'Foito', 'starting_date_time': '2019-10-12T10:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-10-06T18:30:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/c63b5d8bda54fa8810701093aa54ca55-travel-amigo-bonedi-barir-durga', 'address': 'Tollygunge Tram Depot Bus Stand, Jubilee Park, Tollygunge Jubilee Park, Jubilee Park, Jubilee Park, Jubeeli Park, Tollygunge, Kolkata, West Bengal 700033, India', 'title': 'Travel Amigo Bonedi Barir  Durga Puja Parikrama 2019', 'price': ' 2200.0 ', 'organization_name': 'Niladri Roy', 'starting_date_time': '2019-10-06T07:30:00+05:30'}\n",
      "\n",
      "\n",
      "\n",
      "{'ending_date_time': '2019-10-07T17:00:00+05:30', 'url': 'https://www.eventshigh.com/detail/Kolkata/93368d1bcf349d6bedf111250bb7cb23-dugga-dugga-durga-puja-parikrama', 'address': 'The LaLiT Great Eastern Kolkata, 1, 2, 3, Old Court House Street, Dalhousie Square, Near Raj Bhavan, Kolkata, West Bengal 700069', 'title': 'DUGGA DUGGA - Durga Puja Parikrama Bonedibari Durga Darshan 2019', 'price': ' 3250.0 ', 'organization_name': 'RHYTHM GALAXY GROUP', 'starting_date_time': '2019-10-07T07:00:00+05:30'}\n",
      "\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "import requests\n",
    "from bs4 import BeautifulSoup as BS\n",
    "import json\n",
    "\n",
    "try:\n",
    "    page = requests.get(\"https://www.eventshigh.com/city/kolkata\")\n",
    "#     print(\"URL is ok!\")\n",
    "\n",
    "except:\n",
    "    print(\"Somting wrong in url\")\n",
    "    \n",
    "\n",
    "\n",
    "soup = BS(page.text, 'html.parser')\n",
    "scraped_cards = soup.find_all(class_='ga-card-track')\n",
    "# print(res[1])\n",
    "events_detail = []\n",
    "i = 0\n",
    "for i in range(len(scraped_cards)):\n",
    "    events_detail.append('https://www.eventshigh.com'+scraped_cards[i].find('a').get('href'))\n",
    "    \n",
    "\n",
    "all_data = []\n",
    "\n",
    "### ================= testing =============================================================\n",
    "\"\"\"\n",
    "details = requests.get(events_detail[1])\n",
    "details_soup = BS(details.text, 'html.parser')\n",
    "data = details_soup.find_all(\"script\", {'type': 'application/ld+json'})\n",
    "data = data[2].text\n",
    "data = json.loads(data)\n",
    "print(data)\n",
    "print(\"\\n\\n\\n\")\n",
    "\n",
    "organization_name = data[0][\"performer\"][0]['name']\n",
    "name = data[0]['name']\n",
    "url = data[0]['url']\n",
    "address = data[0]['location']['name']+\", \"+data[0]['location']['address']\n",
    "price = data[0][\"offers\"][0]['price']\n",
    "starting_date_time = data[0][\"startDate\"]\n",
    "ending_date_time = data[0][\"endDate\"]\n",
    "\n",
    "print(data[0][\"endDate\"])\n",
    "\"\"\"\n",
    "### ================= testing =============================================================\n",
    "\n",
    "if(len(events_detail)<10):\n",
    "    event_range = len(events_detail)\n",
    "else:\n",
    "    event_range =10\n",
    "\n",
    "for i in range(event_range):\n",
    "    details = requests.get(events_detail[i])\n",
    "    details_soup = BS(details.text, 'html.parser')\n",
    "    data = details_soup.find_all(\"script\", {'type': 'application/ld+json'})\n",
    "    data = data[2].text\n",
    "    data = json.loads(data)\n",
    "    organization_name = data[0][\"performer\"][0]['name']\n",
    "    title = data[0]['name']\n",
    "    url = data[0]['url']\n",
    "    address = data[0]['location']['name']+\", \"+data[0]['location']['address']\n",
    "    price = data[0][\"offers\"][0]['price']\n",
    "    starting_date_time = data[0][\"startDate\"]\n",
    "    ending_date_time = data[0][\"endDate\"]\n",
    "    \n",
    "    all_data.append({'organization_name': organization_name, 'title': title, 'url': url, 'address': address, 'price': price, 'starting_date_time': starting_date_time, 'ending_date_time': ending_date_time })\n",
    "    \n",
    "    print(\"Success!\")\n",
    "    \n",
    "print(\"\\n\\n\")\n",
    "for i in range(len(all_data)):\n",
    "    print(all_data[i])\n",
    "    print(\"\\n\\n\")\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
